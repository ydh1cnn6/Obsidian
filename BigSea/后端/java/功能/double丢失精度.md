---
title: double丢失精度
coordinates:
  - "32.04795"
  - "118.61866"
icon: notebook-pen
iconColor: orange
updateDate: 2025-11-14 00:05:29
---
# 1**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">十进制小数无法精确表示为二进制浮点数</font>**
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">根本原因</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 基于 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">IEEE 754 双精度浮点数标准</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">，使用二进制存储。许多常见的十进制小数（如 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">0.1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">、</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">0.2</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">）在二进制中是无限循环小数，无法用有限的 52 位尾数精确表示。</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">安全范围</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：当字符串表示的整数绝对值 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">≤ 2⁵³（即 9007199254740992）</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 时，</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">可以精确表示。</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">超出范围</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：若字符串整数超过 ±2⁵³，转换为 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 时会</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">丢失精度</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">（无法精确存储每一位数字）。</font>

#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">(1) 精确转换（数值 ≤ 2⁵³）</font>**
```java
String safeIntStr = "9007199254740992"; // 2⁵³
double d = Double.parseDouble(safeIntStr);
System.out.println(d); // 输出 9007199254740992.0（精确）
```

#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">(2) 精度丢失（数值 > 2⁵³）</font>**
``` java
String unsafeIntStr = "9007199254740993"; // 2⁵³ + 1
double d = Double.parseDouble(unsafeIntStr);
System.out.println(d); // 输出 9007199254740992.0（末尾的 3 丢失）
```

---

### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">1.1. 为什么超过 2⁵³ 会丢失精度？</font>**
+ <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">的 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">52 位尾数</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 只能唯一表示最多 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">2⁵³ + 1 个连续整数</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">。超过此范围后，相邻两个</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">值的间隔超过 1，导致无法区分相邻整数。</font>
+ <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">例如：</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">9007199254740993</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">和</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">9007199254740994</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">转换为</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">后可能存储为同一个值。</font>

---

### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">1.2. 如何避免精度丢失？</font>**
| **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">场景</font>** | **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">解决方案</font>** |
| :---: | :---: |
| <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">需要处理大整数（>2⁵³）</font> | <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">使用</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">BigInteger</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">直接解析字符串整数（不转浮点数）</font> |
| <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">必须用浮点数且需要高精度</font> | <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">使用</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">BigDecimal</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">（支持任意精度的十进制数）</font> |
| <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">仅需检查是否丢失精度</font> | <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">比较转换后的</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">和原始字符串是否一致</font> |


### <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">1.3总结</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">字符串整数转</font>****<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font>****<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font>****<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font>****<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">是否会丢精度？</font>**
    - **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">否</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：当整数绝对值 ≤ 2⁵³（如</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">"9007199254740992"</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">）。</font>
    - **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">是</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：当整数绝对值 > 2⁵³（如</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">"9007199254740993"</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">）。</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">关键建议</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：若需处理超大整数，优先使用 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">BigInteger</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 或 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">BigDecimal</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">，避免使用浮点数。</font>



# <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">2. 字符串小数的有效数字超过 15~17 位</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">原因</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 最多能表示 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">15~17 位有效数字</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">，超出的部分会被截断或舍入。</font>


# 3<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">4. 极大或极小小数的指数溢出</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">原因</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">：</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 的指数范围为 </font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">-1022 到 1023</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">，超出此范围的值会溢出为 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">±Infinity</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> 或下溢为 </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">0.0</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">。</font>

### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">5. 关键总结</font>**
|                                                                                                                                     **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">场景</font>**                                                                                                                                     | **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">是否丢失精度</font>** |                                                                                                                                                                                                                                                                      **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">原因</font>**                                                                                                                                                                                                                                                                      |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|   <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">常见小数（如</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">0.1</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">）</font>    |     <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">✔️</font>     |                                                                                                                                                                                                                                                                    <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">二进制无法精确表示</font>                                                                                                                                                                                                                                                                     |
|                                                                                                                               <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">有效数字 ≤ 15~17 位的小数</font>                                                                                                                                |     <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">❌</font>      |                                                                                         <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">在</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">double</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">精度范围内</font>                                                                                          |
|                                                                                                                               <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">有效数字 > 15~17 位的小数</font>                                                                                                                                |     <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">✔️</font>     |                                                                                                                                                                                                                                                                   <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">超出尾数容量，自动舍入</font>                                                                                                                                                                                                                                                                    |
| <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">极大/极小小数（如</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">1e309</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">）</font> |     <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">✔️</font>     | <font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">超出指数范围，溢出为</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">Infinity</font><br/><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);">或</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(252, 252, 252);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgb(243, 243, 243);">0.0</font> |

